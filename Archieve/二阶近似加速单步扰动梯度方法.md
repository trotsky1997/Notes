

## https://arxiv.org/pdf/1909.05840.pdf

è¿™ç¯‡æ–‡ç« é‡Œï¼Œä½œè€…ä½¿ç”¨äº†ä¸€ç§åŸºäºŽçŸ©é˜µè‡ªç”±å¹‚è¿­ä»£æ³•çš„æ–¹æ³•æ¥è®¡ç®—hessiançš„ç‰¹å¾å€¼ï¼Œè€Œä¸éœ€è¦æ˜¾å¼åœ°æž„é€ hessiançŸ©é˜µã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºŽç¬¬iå±‚çš„æ¢¯åº¦giï¼Œå¯¹äºŽä¸€ä¸ªä¸ŽgiåŒç»´åº¦çš„éšæœºå‘é‡vï¼Œæˆ‘ä»¬æœ‰ï¼š
$$
\frac{\partial g_i^T v}{\partial W_i} = \frac{\partial g_i^T}{\partial W_i} v = H_i v
$$
å…¶ä¸­ï¼Œ$H_i$æ˜¯ç¬¬iå±‚çš„hessiançŸ©é˜µã€‚è¿™é‡Œï¼Œç¬¬äºŒä¸ªç­‰å¼æˆç«‹æ˜¯å› ä¸ºvä¸Ž$W_i$æ— å…³ã€‚ç„¶åŽï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¹‚è¿­ä»£æ³•æ¥è®¡ç®—$H_i$çš„æœ€å¤§ç‰¹å¾å€¼ï¼Œç®—æ³•è§é™„å½•ä¸­çš„ç®—æ³•1ã€‚æˆ‘ä»¬ç”¨$\lambda_i$è¡¨ç¤º$H_i$çš„æœ€å¤§ç‰¹å¾å€¼çš„åˆ†å¸ƒï¼Œç”¨10%çš„è®­ç»ƒæ•°æ®æ¥è®¡ç®—ã€‚



æœ‰äº†æ¯ä¸€å±‚çš„Hessiançš„æœ€å¤§ç‰¹å¾å€¼çš„åˆ†å¸ƒï¼Œå¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•è®¡ç®—HessiançŸ©é˜µï¼š

- é¦–å…ˆï¼Œéœ€è¦çŸ¥é“HessiançŸ©é˜µæ˜¯ä¸€ä¸ªäºŒé˜¶å¯¼æ•°çŸ©é˜µï¼Œå®ƒç”±å‡½æ•°çš„æ‰€æœ‰äºŒé˜¶åå¯¼æ•°ç»„æˆã€‚HessiançŸ©é˜µçš„å…¬å¼å¦‚ä¸‹ï¼š
$$
Hf(x) = \begin{bmatrix}
\frac{\partial^2 f}{\partial x_1^2} & \frac{\partial^2 f}{\partial x_1 \partial x_2} & \cdots & \frac{\partial^2 f}{\partial x_1 \partial x_n} \
\frac{\partial^2 f}{\partial x_2 \partial x_1} & \frac{\partial^2 f}{\partial x_2^2} & \cdots & \frac{\partial^2 f}{\partial x_2 \partial x_n} \
\vdots & \vdots & \ddots & \vdots \
\frac{\partial^2 f}{\partial x_n \partial x_1} & \frac{\partial^2 f}{\partial x_n \partial x_2} & \cdots & \frac{\partial^2 f}{\partial x_n^2}
\end{bmatrix}
$$
å…¶ä¸­ï¼Œ$x = (x_1, x_2, \dots, x_n)$æ˜¯å‡½æ•°çš„å˜é‡ï¼Œ$f$æ˜¯å‡½æ•°çš„å€¼ã€‚
- å…¶æ¬¡ï¼Œéœ€è¦çŸ¥é“HessiançŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡çš„æ¦‚å¿µã€‚ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡æ˜¯æ»¡è¶³ä»¥ä¸‹æ–¹ç¨‹çš„æ ‡é‡$\lambda$å’Œéžé›¶å‘é‡$v$ï¼š
$$
Hf(x) v = \lambda v
$$
ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡å¯ä»¥ç”¨çº¿æ€§ä»£æ•°çš„æ–¹æ³•æ±‚è§£ï¼Œä¾‹å¦‚å¹‚è¿­ä»£æ³•æˆ–è€…ç‰¹å¾å€¼åˆ†è§£ã€‚
- æœ€åŽï¼Œå¦‚æžœå·²ç»çŸ¥é“äº†æ¯ä¸€å±‚çš„HessiançŸ©é˜µçš„æœ€å¤§ç‰¹å¾å€¼çš„åˆ†å¸ƒï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ä»¥ä¸‹æ­¥éª¤æ¥è®¡ç®—HessiançŸ©é˜µï¼š
    - å¯¹äºŽæ¯ä¸€å±‚ï¼Œé€‰æ‹©ä¸€ä¸ªéšæœºå‘é‡$v_0$ï¼Œå¹¶ç”¨å¹‚è¿­ä»£æ³•è®¡ç®—æœ€å¤§ç‰¹å¾å€¼$\lambda$å’Œå¯¹åº”çš„ç‰¹å¾å‘é‡$v$ã€‚
    - ç”¨ç‰¹å¾å€¼åˆ†è§£çš„å…¬å¼ï¼Œå°†HessiançŸ©é˜µè¡¨ç¤ºä¸ºï¼š
$$
Hf(x) = V \Lambda V^{-1}
$$
å…¶ä¸­ï¼Œ$V$æ˜¯ä¸€ä¸ªç”±ç‰¹å¾å‘é‡ç»„æˆçš„çŸ©é˜µï¼Œ$\Lambda$æ˜¯ä¸€ä¸ªç”±ç‰¹å¾å€¼ç»„æˆçš„å¯¹è§’çŸ©é˜µã€‚
    - ç”±äºŽåªçŸ¥é“æœ€å¤§ç‰¹å¾å€¼ï¼Œæ‰€ä»¥å¯ä»¥å‡è®¾å…¶ä»–ç‰¹å¾å€¼éƒ½ä¸ºé›¶ï¼Œä»Žè€Œç®€åŒ–HessiançŸ©é˜µçš„è®¡ç®—ã€‚å³ï¼š

$$
Hf(x) \approx v \lambda v^T
$$
å…¶ä¸­ï¼Œ$v$æ˜¯æœ€å¤§ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œ$\lambda$æ˜¯æœ€å¤§ç‰¹å¾å€¼ï¼Œ$v^T$æ˜¯ç‰¹å¾å‘é‡çš„è½¬ç½®ã€‚
è¿™å°±æ˜¯ä¸€ç§å¯èƒ½çš„æ–¹æ³•æ¥è®¡ç®—HessiançŸ©é˜µï¼Œå¸Œæœ›å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚ðŸ˜Š

## Ours

$$
\theta âˆˆ \mathbf{R}^{p}\\
\mathbf{D}_{k} = \hat{H}^{-1}_{k} \\
\hat{\theta}_{k+1}=\hat{\theta}_{k}-\mathbf{D}_{k}\hat{g}_{k}\cdot c_{k}  \\
c_k > 0,c_kâˆˆ \mathbf{R}^{1}\\
\Delta_k =[\Delta_{k1},\Delta_{k2},...\Delta_{kp}],\\\Delta_{ki} \sim B(n,prob),\mathbb{E}[\Delta_{k}]=\mathbf{0}\\
\hat{g}_{k}=\frac{L(\theta_{k}+c_{k}\Delta_{k})+\epsilon_{k}} {c_{k}}\Delta_{k}^{-1}\\
y_{k}=\hat{g}_{k+1}-\hat{g}_{k} \\
s_{k}=-\mathbf{D}_{k}\hat{g}_{k}\cdot c_k \\
\mathbf{D}_{k+1}=\mathbf{D}_{k}+\frac{s_{k}s_{k}^{T}}{s_{k}^{T}y_{k}}-\frac{\mathbf{D}_{k}y_{k}y_{k}^{T}\mathbf{D}_{k}}{y_{k}^{T}\mathbf{D}_{k}y_{k}}
$$

